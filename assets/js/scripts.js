var teams = 
{
	"ANA": 
	{
		"NAME": "Anaheim",
		"SELECT": 1,
		"CURRENT": 105,
		"GAMES_LEFT": 4,
		"ROW": 41,
		"CONFERENCE": "W",
		"DIVISION": "P"
	},
	"ARI": 
	{
		"NAME": "Arizona",
		"SELECT": 1,
		"CURRENT": 54,
		"GAMES_LEFT": 5,
		"ROW": 18,
		"CONFERENCE": "W",
		"DIVISION": "P"
	},
	"BOS":
	{
		"NAME": "Boston",
		"SELECT": 1,
		"CURRENT": 89,
		"GAMES_LEFT": 6,
		"ROW": 35,
		"CONFERENCE": "E",
		"DIVISION": "A"		
	},
	"BUF": 
	{
		"NAME": "Buffalo",
		"SELECT": 1,
		"CURRENT": 50,
		"GAMES_LEFT": 6,
		"ROW": 13,
		"CONFERENCE": "E",
		"DIVISION": "A"	
	},
	"CAR": 
	{
		"NAME": "Carolina",
		"SELECT": 1,
		"CURRENT": 67,
		"GAMES_LEFT": 7,
		"ROW": 24,
		"CONFERENCE": "E",
		"DIVISION": "M"			
	},
	"CGY": 
	{
		"NAME": "Calgary",
		"SELECT": 1,
		"CURRENT": 91,
		"GAMES_LEFT": 5,
		"ROW": 38,
		"CONFERENCE": "W",
		"DIVISION": "P"
	},
	"CHI": 
	{
		"NAME": "Chicago",
		"SELECT": 1,
		"CURRENT": 98,
		"GAMES_LEFT": 6,
		"ROW": 37,
		"CONFERENCE": "W",
		"DIVISION": "C"
	},
	"CBJ": 
	{
		"NAME": "Columbus",
		"SELECT": 1,
		"CURRENT": 76,
		"GAMES_LEFT": 7,
		"ROW": 29,
		"CONFERENCE": "E",
		"DIVISION": "M"	
	},
	"COL": 
	{
		"NAME": "Colorado",
		"SELECT": 1,
		"CURRENT": 82,
		"GAMES_LEFT": 6,
		"ROW": 26,
		"CONFERENCE": "W",
		"DIVISION": "C"
	},
	"DAL": 
	{
		"NAME": "Dallas",
		"SELECT": 1,
		"CURRENT": 84,
		"GAMES_LEFT": 5,
		"ROW": 33,
		"CONFERENCE": "W",
		"DIVISION": "C"
	},
	"DET": 
	{
		"NAME": "Detroit",
		"SELECT": 1,
		"CURRENT": 92,
		"GAMES_LEFT": 7,
		"ROW": 37,
		"CONFERENCE": "E",
		"DIVISION": "A"	
	},
	"EDM": 
	{
		"NAME": "Edmonton",
		"SELECT": 1,
		"CURRENT": 59,
		"GAMES_LEFT": 6,
		"ROW": 18,
		"CONFERENCE": "W",
		"DIVISION": "P"
	},
	"FLA": 
	{
		"NAME": "Florida",
		"SELECT": 1,
		"CURRENT": 85,
		"GAMES_LEFT": 6,
		"ROW": 27,
		"CONFERENCE": "E",
		"DIVISION": "A"	
	},
	"LAK": 
	{
		"NAME": "Los Angeles",
		"SELECT": 1,
		"CURRENT": 88,
		"GAMES_LEFT": 6,
		"ROW": 35,
		"CONFERENCE": "W",
		"DIVISION": "P"
	},
	"MIN": 
	{
		"NAME": "Minnesota",
		"SELECT": 1,
		"CURRENT": 95,
		"GAMES_LEFT": 6,
		"ROW": 40,
		"CONFERENCE": "W",
		"DIVISION": "C"
	},
	"MTL": 
	{
		"NAME": "Montreal",
		"SELECT": 1,
		"CURRENT": 102,
		"GAMES_LEFT": 5,
		"ROW": 41,
		"CONFERENCE": "E",
		"DIVISION": "A"	
	},
	"NJD": 
	{
		"NAME": "New Jersey",
		"SELECT": 1,
		"CURRENT": 74,
		"GAMES_LEFT": 6,
		"ROW": 27,
		"CONFERENCE": "E",
		"DIVISION": "M"	
	},
	"NSH": 
	{
		"NAME": "Nashville",
		"SELECT": 1,
		"CURRENT": 102,
		"GAMES_LEFT": 5,
		"ROW": 41,
		"CONFERENCE": "W",
		"DIVISION": "C"
	},
	"NYI": 
	{
		"NAME": "NY Islanders",
		"SELECT": 1,
		"CURRENT": 95,
		"GAMES_LEFT": 5,
		"ROW": 38,
		"CONFERENCE": "E",
		"DIVISION": "M"	
	},
	"NYR": 
	{
		"NAME": "NY Rangers",
		"SELECT": 1,
		"CURRENT": 101,
		"GAMES_LEFT": 7,
		"ROW": 43,
		"CONFERENCE": "E",
		"DIVISION": "M"	
	},
	"OTT": 
	{
		"NAME": "Ottawa",
		"SELECT": 1,
		"CURRENT": 86,
		"GAMES_LEFT": 7,
		"ROW": 32,
		"CONFERENCE": "E",
		"DIVISION": "A"	
	},
	"PHI": 
	{
		"NAME": "Philadelphia",
		"SELECT": 1,
		"CURRENT": 77,
		"GAMES_LEFT": 6,
		"ROW": 27,
		"CONFERENCE": "E",
		"DIVISION": "M"	
	},
	"PIT": 
	{
		"NAME": "Pittsburgh",
		"SELECT": 1,
		"CURRENT": 95,
		"GAMES_LEFT": 6,
		"ROW": 38,
		"CONFERENCE": "E",
		"DIVISION": "M"	
	},
	"SJS": 
	{
		"NAME": "San Jose",
		"SELECT": 1,
		"CURRENT": 83,
		"GAMES_LEFT": 6,
		"ROW": 33,
		"CONFERENCE": "W",
		"DIVISION": "P"
	},
	"STL": 
	{
		"NAME": "St. Louis",
		"SELECT": 1,
		"CURRENT": 99,
		"GAMES_LEFT": 6,
		"ROW": 37,
		"CONFERENCE": "W",
		"DIVISION": "C"
	},
	"TBL": 
	{
		"NAME": "Tampa Bay",
		"SELECT": 1,
		"CURRENT": 101,
		"GAMES_LEFT": 5,
		"ROW": 45,
		"CONFERENCE": "E",
		"DIVISION": "A"	
	},
	"TOR": 
	{
		"NAME": "Toronto",
		"SELECT": 1,
		"CURRENT": 62,
		"GAMES_LEFT": 7,
		"ROW": 24,
		"CONFERENCE": "E",
		"DIVISION": "A"	
	},
	"VAN": 
	{
		"NAME": "Vancouver",
		"SELECT": 1,
		"CURRENT": 93,
		"GAMES_LEFT": 6,
		"ROW": 40,
		"CONFERENCE": "W",
		"DIVISION": "P"
	},
	"WPG": 
	{
		"NAME": "Winnipeg",
		"SELECT": 1,
		"CURRENT": 90,
		"GAMES_LEFT": 6,
		"ROW": 32,
		"CONFERENCE": "W",
		"DIVISION": "C"
	},
	"WSH": 
	{
		"NAME": "Washington",
		"SELECT": 1,
		"CURRENT": 92,
		"GAMES_LEFT": 6,
		"ROW": 37,
		"CONFERENCE": "E",
		"DIVISION": "M"	
	}
};

var gamesLeft = 
{				
	"30":{
		"HOME": "TOR",
		"AWAY": "TBL",
		"DATE": 1427760000000
	},		
	"11":{
		"HOME": "BUF",
		"AWAY": "TOR",
		"DATE": 1427846400000
	},
	"21":{
		"HOME": "ANA",
		"AWAY": "EDM",
		"DATE": 1427846400000
	},					
	"22":{
		"HOME": "LAK",
		"AWAY": "EDM",
		"DATE": 1427932800000
	},		
	"5":{
		"HOME": "SJS",
		"AWAY": "ARI",
		"DATE": 1428019200000
	},
	"12":{
		"HOME": "BUF",
		"AWAY": "CHI",
		"DATE": 1428019200000
	},
	"13":{
		"HOME": "NYI",
		"AWAY": "BUF",
		"DATE": 1428105600000
	},
	"23":{
		"HOME": "EDM",
		"AWAY": "CGY",
		"DATE": 1428105600000
	},
	"148":{
		"HOME": "BOS",
		"AWAY": "TOR",
		"DATE": 1428105600000// 4/4
	},						
	"29":{
		"HOME": "TOR",
		"AWAY": "OTT",
		"DATE": 1428192000000 // 4/5
	},	
	"14":{
		"HOME": "BUF",
		"AWAY": "CAR",
		"DATE": 1428278400000
	},
	"6":{
		"HOME": "ARI",
		"AWAY": "CGY",
		"DATE": 1428364800000
	},
	"24":{
		"HOME": "EDM",
		"AWAY": "LAK",
		"DATE": 1428364800000
	},	
	"28":{
		"HOME": "CBJ",
		"AWAY": "TOR",
		"DATE": 1428451200000
	},	
	"7":{
		"HOME": "VAN",
		"AWAY": "ARI",
		"DATE": 1428537600000
	},
	"25":{
		"HOME": "EDM",
		"AWAY": "SJS",
		"DATE": 1428537600000
	},			
	"15":{
		"HOME": "CBJ",
		"AWAY": "BUF",
		"DATE": 1428624000000
	},
	"8":{
		"HOME": "ANA",
		"AWAY": "ARI",
		"DATE": 1428710400000
	},
	"16":{
		"HOME": "BUF",
		"AWAY": "PIT",
		"DATE": 1428710400000
	},
	"26":{
		"HOME": "VAN",
		"AWAY": "EDM",
		"DATE": 1428710400000
	},
	"27":{
		"HOME": "TOR",
		"AWAY": "MTL",
		"DATE": 1428710400000
	},	
	"81":{
	"HOME": "FLA",
	"AWAY": "BOS",
	"DATE": 1427760000000
	},
	"82":{
	"HOME": "NJD",
	"AWAY": "CBJ",
	"DATE": 1427760000000
	},
	"83":{
	"HOME": "CAR",
	"AWAY": "WSH",
	"DATE": 1427760000000
	},
	"84":{
	"HOME": "OTT",
	"AWAY": "DET",
	"DATE": 1427760000000
	},
	"85":{
	"HOME": "NYR",
	"AWAY": "WPG",
	"DATE": 1427760000000
	},
	"86":{
	"HOME": "VAN",
	"AWAY": "NSH",
	"DATE": 1427760000000
	},
	"87":{
	"HOME": "PHI",
	"AWAY": "PIT",
	"DATE": 1427846400000
	},
	"88":{
	"HOME": "COL",
	"AWAY": "SJS",
	"DATE": 1427846400000
	},
	"89":{
	"HOME": "NYI",
	"AWAY": "CBJ",
	"DATE": 1427932800000
	},
	"90":{
	"HOME": "BOS",
	"AWAY": "DET",
	"DATE": 1427932800000
	},
	"91":{
	"HOME": "WSH",
	"AWAY": "MTL",
	"DATE": 1427932800000
	},
	"92":{
	"HOME": "TBL",
	"AWAY": "OTT",
	"DATE": 1427932800000
	},
	"93":{
	"HOME": "CAR",
	"AWAY": "FLA",
	"DATE": 1427932800000
	},
	"94":{
	"HOME": "NYR",
	"AWAY": "MIN",
	"DATE": 1427932800000
	},
	"95":{
	"HOME": "CGY",
	"AWAY": "STL",
	"DATE": 1427932800000
	},
	"96":{
	"HOME": "VAN",
	"AWAY": "CHI",
	"DATE": 1427932800000
	},
	"97":{
	"HOME": "MTL",
	"AWAY": "NJD",
	"DATE": 1428019200000
	},
	"98":{
	"HOME": "STL",
	"AWAY": "DAL",
	"DATE": 1428019200000
	},
	"99":{
	"HOME": "COL",
	"AWAY": "ANA",
	"DATE": 1428019200000
	},
	"100":{
	"HOME": "PHI",
	"AWAY": "CAR",
	"DATE": 1428105600000
	},
	"101":{
	"HOME": "PIT",
	"AWAY": "CBJ",
	"DATE": 1428105600000
	},
	"102":{
	"HOME": "VAN",
	"AWAY": "WPG",
	"DATE": 1428105600000
	},
	"103":{
	"HOME": "WSH",
	"AWAY": "OTT",
	"DATE": 1428105600000
	},
	"104":{
	"HOME": "DET",
	"AWAY": "MIN",
	"DATE": 1428105600000
	},
	"105":{
	"HOME": "TBL",
	"AWAY": "FLA",
	"DATE": 1428105600000
	},
	"106":{
	"HOME": "NJD",
	"AWAY": "NYR",
	"DATE": 1428105600000
	},
	"107":{
	"HOME": "DAL",
	"AWAY": "NSH",
	"DATE": 1428105600000
	},
	"108":{
	"HOME": "COL",
	"AWAY": "LAK",
	"DATE": 1428105600000
	},
	"109":{
	"HOME": "MTL",
	"AWAY": "FLA",
	"DATE": 1428192000000
	},
	"110":{
	"HOME": "WSH",
	"AWAY": "DET",
	"DATE": 1428192000000
	},
	"111":{
	"HOME": "PIT",
	"AWAY": "PHI",
	"DATE": 1428192000000
	},
	"112":{
	"HOME": "STL",
	"AWAY": "CHI",
	"DATE": 1428192000000
	},
	"113":{
	"HOME": "CBJ",
	"AWAY": "NYR",
	"DATE": 1428278400000
	},
	"114":{
	"HOME": "WPG",
	"AWAY": "MIN",
	"DATE": 1428278400000
	},
	"115":{
	"HOME": "LAK",
	"AWAY": "VAN",
	"DATE": 1428278400000
	},
	"116":{
	"HOME": "DAL",
	"AWAY": "SJS",
	"DATE": 1428278400000
	},
	"117":{
	"HOME": "NYR",
	"AWAY": "NJD",
	"DATE": 1428364800000
	},
	"118":{
	"HOME": "NYI",
	"AWAY": "PHI",
	"DATE": 1428364800000
	},
	"119":{
	"HOME": "PIT",
	"AWAY": "OTT",
	"DATE": 1428364800000
	},
	"120":{
	"HOME": "CAR",
	"AWAY": "DET",
	"DATE": 1428364800000
	},
	"121":{
	"HOME": "WPG",
	"AWAY": "STL",
	"DATE": 1428364800000
	},
	"122":{
	"HOME": "MIN",
	"AWAY": "CHI",
	"DATE": 1428364800000
	},
	"123":{
	"HOME": "NSH",
	"AWAY": "COL",
	"DATE": 1428364800000
	},
	"124":{
	"HOME": "BOS",
	"AWAY": "WSH",
	"DATE": 1428451200000
	},
	"125":{
	"HOME": "DAL",
	"AWAY": "ANA",
	"DATE": 1428451200000
	},
	"126":{
	"HOME": "OTT",
	"AWAY": "NYR",
	"DATE": 1428537600000
	},
	"127":{
	"HOME": "CAR",
	"AWAY": "PHI",
	"DATE": 1428537600000
	},
	"128":{
	"HOME": "BOS",
	"AWAY": "FLA",
	"DATE": 1428537600000
	},
	"129":{
	"HOME": "DET",
	"AWAY": "MTL",
	"DATE": 1428537600000
	},
	"130":{
	"HOME": "NJD",
	"AWAY": "TBL",
	"DATE": 1428537600000
	},
	"131":{
	"HOME": "CHI",
	"AWAY": "STL",
	"DATE": 1428537600000
	},
	"132":{
	"HOME": "MIN",
	"AWAY": "NSH",
	"DATE": 1428537600000
	},
	"133":{
	"HOME": "WPG",
	"AWAY": "COL",
	"DATE": 1428537600000
	},
	"134":{
	"HOME": "LAK",
	"AWAY": "CGY",
	"DATE": 1428537600000
	},
	"135":{
	"HOME": "NYI",
	"AWAY": "PIT",
	"DATE": 1428624000000
	},
	"136":{
	"HOME": "OTT",
	"AWAY": "PHI",
	"DATE": 1428710400000
	},
	"137":{
	"HOME": "NYR",
	"AWAY": "WSH",
	"DATE": 1428710400000
	},
	"138":{
	"HOME": "CGY",
	"AWAY": "WPG",
	"DATE": 1428710400000
	},
	"139":{
	"HOME": "SJS",
	"AWAY": "LAK",
	"DATE": 1428710400000
	},
	"140":{
	"HOME": "DET",
	"AWAY": "CAR",
	"DATE": 1428710400000
	},
	"141":{
	"HOME": "NJD",
	"AWAY": "FLA",
	"DATE": 1428710400000
	},
	"142":{
	"HOME": "CBJ",
	"AWAY": "NYI",
	"DATE": 1428710400000
	},
	"143":{
	"HOME": "BOS",
	"AWAY": "TBL",
	"DATE": 1428710400000
	},
	"144":{
	"HOME": "MIN",
	"AWAY": "STL",
	"DATE": 1428710400000
	},
	"145":{
	"HOME": "NSH",
	"AWAY": "DAL",
	"DATE": 1428710400000
	},
	"146":{
	"HOME": "CHI",
	"AWAY": "COL",
	"DATE": 1428710400000
	},
	"147":{
		"HOME": "ARI",
		"AWAY": "SJS",
		"DATE": 1428105600000
	}
};

var divisions = {"M": "Metropolitan", "A": "Atlantic", "P": "Pacific", "C": "Central"};
var conferences = {"E": "Eastern", "W": "Western"};


var preDefinedTeams = 
{
	"tankTeams": ["ARI", "BUF", "EDM"],
	"easternPlayoff": ["FLA", "BOS", "OTT"],
	"westernPlayoff": ["VAN", "LAK", "CGY", "WPG"]
};

$(document).ready(function(){
	//DISPLAY TEAMS
	var teamAllTemplate = "<tr><td><input type='checkbox' id='{{Abbrv}}-View' class='standings-view'></td><td><img height='20' width='20' src='assets/img/{{Abbrv}}.png'></img></td><td>{{Name}}</td>" 
						+"<td>{{Conference}}</td><td>{{Division}}</td>"
						+"<td>{{Points}}</td>"+
						"<td>{{ROW}}</td>" +
						+"</tr>";
	var teamSelectedTemplate = "<tr id='{{Abbrv}}-SelRow' class='selected-row'></td><td><img height='20' width='20' src='assets/img/{{Abbrv}}.png'></img></td><td>{{Name}}</td>" 
						+"<td>{{Conference}}</td><td>{{Division}}</td>"
						+ "<td id='{{Abbrv}}-Sim'>{{Points}}</td>"
						+ "<td id='{{Abbrv}}-ROW'>{{ROW}}</td>"
						+ "<td id='{{Abbrv}}-GL'>{{GamesLeft}}</td>"
						+ "<td id='{{Abbrv}}-Status'><strong>W</strong>: 0 | <strong>OTL</strong>: 0 | <strong>L</strong>: 0</td>"
						+"</tr>";
	for (var team in teams) {
		teams[team]["CALC_GAMES_LEFT"] = teams[team]["GAMES_LEFT"];
		var teamData = {"Abbrv": team, 
		  	"Name": teams[team]["NAME"], 
		  	"Points": teams[team]["CURRENT"], 
		  	"GamesLeft": teams[team]["CALC_GAMES_LEFT"], 
		  	"ROW": teams[team]["ROW"],
		  	"Conference": conferences[teams[team]["CONFERENCE"]],
		  	"Division": divisions[teams[team]["DIVISION"]]}
		var allHtml = Mustache.to_html(teamAllTemplate, teamData);
		$(allHtml).appendTo("#tankTeams");
		var selectedHTML = Mustache.to_html(teamSelectedTemplate, teamData);
		$(selectedHTML).appendTo("#selectedTeamsBody");
		teams[team]["SELECT"] = 0;
		teams[team]["W"] = 0;
		teams[team]["L"] = 0;
		teams[team]["OTL"] = 0;
	}

	$(".selected-row").each(function(i, obj){
		$(obj).hide();
	});

	// start team table hidden
	$("#teamTable").toggle();

	function getSelectedTeams(){
		var selectedTeams = []
		for (var team in teams) {
			if (teams[team]["SELECT"] === 1){
			  selectedTeams.push(team);
			}
		}
		return selectedTeams;
	}

	// GENERATE GAMES
	var gameTemplate = "<tr id='{{GameID}}-Row' class='GameRow'><td>{{Date}}</td><td>{{Home}}</td><td>{{Away}}</td>"
		+ "<td>" // ot radios
		+ "<input type='radio' name='{{GameID}}-OT' id='{{GameID}}-OT-N' class='game-ot' value='{{GameID}}-OT-N' checked>None  " 
		+ "<input type='radio' name='{{GameID}}-OT' id='{{GameID}}-OT-O' class='game-ot' value='{{GameID}}-OT-O'>OT  "
		+ "<input type='radio' name='{{GameID}}-OT' id='{{GameID}}-OT-S' class='game-ot' value='{{GameID}}-OT-S'>SO  "
		+ "</td>"
		+"<td>" // winner radios
		+ "<input type='radio' name='{{GameID}}-Winner' id='{{GameID}}-{{Home}}' class='game-result' value='{{Home}}'>{{Home}}    "
		+ "<input type='radio' name='{{GameID}}-Winner' id='{{GameID}}-{{Away}}' class='game-result' value='{{Away}}'>{{Away}}    "
		+ "</td><td id='{{GameID}}-WinPic'></td>"
		+ "<td>{{Month}}</td><td>{{Day}}</td>";

	// Add games and write via template
	for (var game in gamesLeft){
		var gameDate = new Date(parseInt(gamesLeft[game]["DATE"]));
		gameDate.setDate(gameDate.getDate() + 1); //add 1 to date
		var dateStr = gameDate.getFullYear();
		var dd = gameDate.getDate();
		var mm = gameDate.getMonth() + 1;
		var y = gameDate.getFullYear();

		var formattedDate = mm + '/'+ dd + '/'+ y;
		var gameData = {
					"Date": formattedDate, 
					// "Date": gameDate,
					"Away": gamesLeft[game]["AWAY"],
					"Home": gamesLeft[game]["HOME"],
					"GameID": game,
					"Month": mm,
					"Day": dd
					};
		var html = Mustache.to_html(gameTemplate, gameData);
		$(html).appendTo("#gameData");
		gamesLeft[game]["OT"] = "N";
		// if team is one of the selected auto-check. first, check away. do this to avoid duplicate attempts at selecting.
		// if (isSelectedTeam(gamesLeft[game]["AWAY"])){
		// 	$("#" + game + "-" + gamesLeft[game]["HOME"]).prop("checked", true);
		// 	gamesLeft[game]["WIN"] = gamesLeft[game]["HOME"];
		// 	$("#" + game + "-WinPic").html("<img height='20' width='20' src='assets/img/" + gamesLeft[game]["HOME"] + ".png'></img>");
		// }
		// // if not, selected team is the home team. check that one.
		// else{
		// 	$("#" + game + "-" + gamesLeft[game]["AWAY"]).prop("checked", true);
		// 	gamesLeft[game]["WIN"] = gamesLeft[game]["AWAY"];
		// 	$("#" + game + "-WinPic").html("<img height='20' width='20' src='assets/img/" + gamesLeft[game]["AWAY"] + ".png'></img>");
		// }
	}

	$(".GameRow").each(function(i, obj){
		$(obj).hide();
	});


	updatePoints();

	function isSelectedTeam(team) {
	  return getSelectedTeams().indexOf(team) > -1;
	}

	$(".game-result").change(function(){
		var gameID = this.id.split("-")[0];
		gamesLeft[gameID]["WIN"] = this.id.split("-")[1];
		$("#" + gameID + "-WinPic").html("<img height='20' width='20' src='assets/img/" + this.id.split("-")[1] + ".png'></img>");
		updatePoints();
	});

	// When OT is placed in, update point totals
	$(".game-ot").change(function(){
		//  Update gamesLeft object
		var gameID = this.id.split("-")[0];
		var otType = this.id.split("-")[2];
		gamesLeft[gameID]["OT"] = otType;	
		updatePoints();
	});

	$("#prePopulateTeams").change(function(){
		// first, unselect currently selected
		for (var team in teams){
			teams[team]["SELECT"] = 0;
			$("#" + team + "-View").prop("checked", false);
		}

		// clear selected teams grid
		$(".selected-row").each(function(i, obj){
			$(obj).hide();
		});

		var teamType = $("#prePopulateTeams").val();
		if (teamType !== ""){
			for(var i=0; i < preDefinedTeams[teamType].length; i++){
				teams[preDefinedTeams[teamType][i]]["SELECT"] = 1;
				$("#" + preDefinedTeams[teamType][i] + "-View").prop("checked", true);
				updateSelectedGrid(preDefinedTeams[teamType][i]);

			}
			updateGameGrid();
		}

	});

	// When select team, update grid of games and SELECT state of team.
	$(".standings-view").change(function(){
		//  Update gamesLeft object
		var teamID = this.id.split("-")[0];
		if ($(this).is(":checked")){
			teams[teamID]["SELECT"] = 1;
		}
		else{
			teams[teamID]["SELECT"] = 0;
		}
		updateGameGrid();
		updateSelectedGrid(teamID);
		
	});

	// Minimize ALL table when clicked
	$("#hideTable").click(function(){
		//  Hide table when clicked
		$("#teamTable").toggle();
		
	});

	// Update grid view based on selected teams.
	function updateGameGrid(){
		// hide teams not currently selected
		$(".GameRow").each(function(i, obj){
			var gameID = obj.id.split("-")[0];
			var homeTeam = gamesLeft[gameID]["HOME"];
			var awayTeam = gamesLeft[gameID]["AWAY"];

			if (isSelectedTeam(homeTeam) || isSelectedTeam(awayTeam)){
				$(obj).show();
			}
			else{
				$(obj).hide();
			}
		});

	}

	function updateSelectedGrid(team){
		$("#" + team + "-SelRow").toggle();
	}
	

	// There is a better way to do this, but life goes on.
	function updatePoints(){
		// reset all points to current
		for (var team in teams) {
			// if (teams[team]["SELECT"] === 1){
				teams[team]["CALC"] = teams[team]["CURRENT"];
				teams[team]["CALC_ROW"] = teams[team]["ROW"];
				teams[team]["CALC_GAMES_LEFT"] = teams[team]["GAMES_LEFT"];
				teams[team]["W"] = 0;
				teams[team]["L"] = 0;
				teams[team]["OTL"] = 0;
			// }
			
		}

		// add up the points, dude
		for (var game in gamesLeft){
			var winningTeam = gamesLeft[game]["WIN"];
			var homeTeam = gamesLeft[game]["HOME"];
			var awayTeam = gamesLeft[game]["AWAY"];
			if (winningTeam !== undefined && winningTeam != ""){
				// if we are calculating points for the winner, then add
				if (teams[winningTeam]["SELECT"] === 1){
					teams[winningTeam]["CALC_GAMES_LEFT"] = teams[winningTeam]["CALC_GAMES_LEFT"] - 1;
					// get the winning team, first. add 2 points.
					teams[winningTeam]["CALC"] = teams[winningTeam]["CALC"] + 2;
					teams[winningTeam]["W"] = teams[winningTeam]["W"] + 1;
					// only add to ROW if not a shoot-out
					if (gamesLeft[game]["OT"] !== "S"){
						teams[winningTeam]["CALC_ROW"] = teams[winningTeam]["CALC_ROW"] + 1;
					}
				}
				// get loser team -- they are the team that did not win.
				if (homeTeam === winningTeam){
					var losingTeam = awayTeam;
				}
				else{
					var losingTeam = homeTeam;
				}
				teams[losingTeam]["CALC_GAMES_LEFT"] = teams[losingTeam]["CALC_GAMES_LEFT"] - 1;
				// if game went to OT, give out loser point.
				if (gamesLeft[game]["OT"] === "O" || gamesLeft[game]["OT"] === "S"){
					// Give losing team a OTL point.
					teams[losingTeam]["CALC"] = teams[losingTeam]["CALC"] + 1;
					teams[losingTeam]["OTL"] = teams[losingTeam]["OTL"] + 1;
				}
				// otherwise, the team just lost.
				else{
					teams[losingTeam]["L"] = teams[losingTeam]["L"] + 1;
				}
				

			}
		}

		// Update grid
		for (var team in teams) {
			if (teams[team]["SELECT"] === 1){
				$("#" + team + "-Sim").text(teams[team]["CALC"]); // set simulated points
				$("#" + team + "-ROW").text(teams[team]["CALC_ROW"]); // set simulated ROW
				var statusText = "<strong>W</strong>: " + teams[team]["W"] +
									" | <strong>OTL</strong>: " + teams[team]["OTL"] +
									" | <strong>L</strong>: " + teams[team]["L"];
				$("#" + team + "-Status").html(statusText)
				$("#" + team + "-GL").text(teams[team]["CALC_GAMES_LEFT"]);
			}
			
		}

	}
	$("#teamTable").DataTable({"order": [[5, "desc"], [6, "desc"]], paging: false, bInfo: false, autoWidth: false});
	$("#gamesTable").DataTable({"order": [[6, "asc"], [7, "asc"]], paging: false, bInfo: false, columnDefs: [{targets: [6, 7], visible: false}], autoWidth: false});
})
